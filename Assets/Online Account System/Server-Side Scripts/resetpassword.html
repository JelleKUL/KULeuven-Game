<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"

// RESETPASSWORD.HTML
// INPUT: (id, hash) via getParams (works like PHP's _GET)
// FUNCTIONALITY: Gets and confirms a new password from the form and then passes the INPUT plus the password to UPDATEPASSWORD.PHP
>
<HTML>
<head>
    <meta name="generator" content="HTML Tidy for Windows (vers 1 June 2005), see www.w3.org">
    <meta http-equiv="Content-Language" content="en-au">
    <meta name="GENERATOR" content="Microsoft FrontPage 6.0">
    <meta name="ProgId" content="FrontPage.Editor.Document">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <title>Reset Password
    </title>

    <!-- Load the verifynotify javascript code -->
    <script type="text/javascript" src="verifynotify.js"></script>
    <script language="JavaScript" type="text/javascript">
        <!--
    function verifynotify(field1, field2, button_id, result_id, match_html, nomatch_html) {
        this.field1 = field1;
        this.field2 = field2;
        this.button_id = button_id;
        this.result_id = result_id;
        this.match_html = match_html;
        this.nomatch_html = nomatch_html;

        this.check = function () {

            /* Make sure we don't cause an error
             for browsers that do not support getElementById 
             ALWAYS USE COMMENTS LIKE /* 
             
             */
            if (!this.result_id) { return false; }
            if (!this.button_id) { return false; }
            if (!document.getElementById) { return false; }
            r = document.getElementById(this.result_id);
            if (!r) { return false; }
            b = document.getElementById(this.button_id);
            if (!b) { return false; }


            if (this.field1.value != "" && this.field1.value == this.field2.value) {
                r.innerHTML = this.match_html;
                b.disabled = false;
            } else {
                r.innerHTML = this.nomatch_html;
                b.disabled = true;
            }
        }
    }

    function SymError() {
        return true;
    }

    window.onerror = SymError;

    var SymRealWinOpen = window.open;

    function SymWinOpen(url, name, attributes) {
        return (new Object());
    }

    window.open = SymWinOpen;

    //-->
        </script>

    <script language="JavaScript" type="text/javascript">
            
              <!-- Begin
    function getParams() {
        var idx = document.URL.indexOf('?');
        var tempParams = new Object();
        if (idx != -1) {
            var pairs = document.URL.substring(idx + 1, document.URL.length).split('&');
            for (var i = 0; i < pairs.length; i++) {
                nameVal = pairs[i].split('=');
                tempParams[nameVal[0]] = nameVal[1];
            }
            return tempParams;
        }
    }
    var params = getParams();
</script>
</head>
<body>
    <h1></h1>

    <form id="PasswordChange" name="password_form" action="updatepassword.php" method="POST">
        New Password:<br>
        <input type="password" name="newpassword" onkeyup="verify.check()">
<p>

            Re-enter Password:<br>
            <input type="password" name="passwordver" onkeyup="verify.check()">

            </p>
            <!-- Display a message if the passwords match or don't match -->
            <div id="password_result">&nbsp;</div>
                <input type="hidden" name="id">
            <input type="hidden" name="hash">
    
        <p>
            <button id="button_activate" type="submit" disabled="disabled">Change Password</button>
        </p>
    </form>
</body>
</HTML>
    <script type="text/javascript">

    verify = new verifynotify();
    verify.field1 = document.password_form.newpassword;
    verify.field2 = document.password_form.passwordver;
    verify.button_id = "button_activate";
    verify.result_id = "password_result";
    verify.match_html = "<SPAN STYLE=\"color:blue\"><\/SPAN>";
    verify.nomatch_html = "<SPAN STYLE=\"color:red\">Please make sure your passwords match.<\/SPAN>";


</script>
    <script language="JavaScript" type="text/javascript">
   
    pvName = unescape(params["id"]);
    if (pvName) document.password_form.id.value = pvName;
    pvName = unescape(params["hash"]);
    if (pvName) document.password_form.hash.value = pvName;

    </script>

    <script language="JavaScript" type="text/javascript">

    var SymRealOnLoad;
    var SymRealOnUnload;

    function SymOnUnload() {
        window.open = SymWinOpen;
        if (SymRealOnUnload != null)
            SymRealOnUnload();
    }

    function SymOnLoad() {
        if (SymRealOnLoad != null)
            SymRealOnLoad();
        window.open = SymRealWinOpen;
        SymRealOnUnload = window.onunload;
        window.onunload = SymOnUnload;
    }

    SymRealOnLoad = window.onload;
    window.onload = SymOnLoad;

</script>
